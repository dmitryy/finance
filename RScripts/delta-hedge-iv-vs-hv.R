# delta hedge hv vs iv

source('C:/Work Home/finance/RScripts/common/functions.R')

s0 = 100
volatility = 0.2
drift = 0.3
rate = 0.05

strike = 100
expiry = 1
iv = 0.4
hv = 0.2

timestep = 0.01

n = 100
s = array(n)
t = seq(0, timestep * (n - 1), by = timestep)

#for (i in 1:n) {
#  if (i == 1) {
#    s[i] = s0
#  }
#  else {
#    s[i] = nextPrice(s[i - 1], volatility)
#  }
#}

par(mfrow=c(1,1))

#plot(s, type = "line")
#plot(t, type = "line")

# asset: SiU9, expires in 11 days, price: 65824, Trade date: 06.09.2019 0:00:00
#asset = 65824
#expiry = 1 / 252 * 11
#callStrikes = c(60000,62000,64000,64500,65000,65500,65750,66000,66250,66500,66750,67000,67250,67500,68000,68500,69000,69250,69500,69750,70000,70250,70500,71000,71500,72000,73000,73500,75000,80000)
#callPrices = c(5880,3932,1963,1360,1000,620,500,410,290,250,183,151,132,112,71,48,35,44,30,36,20,29,19,17,15,11,5,5,3,6)
#putStrikes = c(60000,62000,62500,63000,63500,64000,64250,64500,64750,65000,65250,65500,65750,66000,66250,66500,66750,67000,67500,68000,69000)
#putPrices = c(5,7,10,11,22,42,75,80,115,171,233,322,499,602,700,957,1020,1330,1797,2244,3050)

Open = c(72050,71083,70001,69269,69250,69225,69150,69193,69246,68570,68521,68400,68500,68636,68250,67838,68103,68300,68115,67788,67558,67488,67570,67590,67888,68000,67611,67738,67450,67638,69030,68478,68100,67888,67480,67328,67225,67200,67675,67628,67650,67575,67425,67525,67675,67878,67680,67339,67096,67140,66800,66072,65989,65931,65398,66301,65639,65886,66529,66598,67227,66995,66981,66654,67007,66808,66465,66360,65765,66080,65739,65702,65637,65312,65325,65396,65130,65068,65602,66078,66078,65795,65807,66797,66330,66500,66497,66162,66397,66604,66148,65660,65690,65829,65600,65511,65445,65808,65574,65444,65693,66225,66181,66329,66400,66218,66341,66078,65809,65617,65413,65450,65200,65090,64851,64660,63798,64080,63544,63626,63820,63850,63839,63642,64008,64179,64108,64481,64146,64365,63765,63448,63600,63190,63380,63330,63621,63525,63561,63750,63600,63660,63895,63926,64081,63900,64297,65600,65456,65675,65966,65510,65841,65835,65344,66240,66480,66761,67102,66865,66075,65974,66270,66249,66773,66777,66721,66934,66898,67190,66262,66233)
High = c(72123,71083,70121,69549,69528,69371,69527,69316,69246,68788,68569,68609,68665,68646,68250,68256,68253,68520,68130,67788,67724,67650,67658,67888,68061,68100,67688,67738,68038,69028,69091,68478,68178,67888,67528,67478,67228,67650,67768,67675,67678,67678,67550,67729,67830,67950,67680,67339,67260,67208,66800,66100,66065,65947,66350,66389,66039,66514,66821,67297,67401,67107,67011,67129,67041,66938,66501,66417,66050,66150,65810,65850,65637,65535,65423,65418,65205,65630,66270,66155,66163,65912,66775,66808,66738,66502,66650,66601,66698,66631,66153,65810,66015,65900,65713,65562,66007,65982,65600,65793,66426,66259,66610,66625,66441,66305,66392,66134,65838,65707,65703,65482,65256,65241,64931,64710,64590,64130,63699,64020,63977,63932,64161,64106,64358,64199,64499,64631,64530,64572,63832,63767,63612,63443,63649,63690,63621,63580,63845,63802,63798,63965,64084,64178,64126,64574,65845,65884,66003,66089,66029,65895,66032,66212,66400,66904,66783,67307,67375,66872,66189,66358,66444,66785,67183,67118,66997,66979,67245,67294,66368,66409)
Low = c(71190,70075,69200,68979,68947,69099,69100,69120,68656,68445,68290,68351,68500,68300,67891,67838,68006,68188,67962,67245,67388,67450,67400,67590,67888,67738,67500,67400,67338,67638,68478,68002,67978,67478,67234,67160,66975,67200,67450,67460,67375,67400,67425,67453,67545,67650,67328,67020,66978,66800,65750,65779,65790,65245,65270,65531,65481,65886,66250,66045,66837,66691,66573,66654,66635,66431,66085,65776,65658,65526,65587,65550,65205,65170,65246,65068,65000,64984,65602,65857,65671,65555,65756,66244,66219,66183,66053,66143,66215,66072,65630,65548,65611,65510,65435,65233,65433,65470,65400,65421,65674,65917,66059,66182,66075,65948,66005,65695,65551,65328,65389,65054,64974,64739,64634,63736,63676,63539,63263,63526,63684,63566,63480,63642,63905,63954,64051,64140,64102,63739,63433,63351,63103,63182,63276,63207,63280,63410,63558,63463,63281,63511,63794,63651,63778,63514,64243,65241,65375,65322,65408,65400,65527,65199,65100,65985,66133,66514,66818,66032,65689,65732,66044,66214,66488,66686,66450,66707,66898,66232,66004,65680)
Close = c(71344,70075,69200,68979,69528,69347,69271,69120,68670,68788,68490,68524,68665,68300,67892,68250,68238,68188,67965,67480,67638,67644,67600,67759,67900,67738,67688,67538,67550,69018,68528,68070,67978,67478,67234,67250,67175,67620,67650,67625,67550,67450,67550,67729,67788,67766,67351,67075,67260,66811,66035,66000,65903,65418,66281,65639,65886,66514,66610,67291,66965,67033,66654,66992,66761,66466,66364,65780,66050,65705,65690,65641,65313,65316,65399,65152,65100,65565,66044,66043,65775,65789,66720,66317,66494,66467,66146,66435,66596,66140,65658,65628,65843,65599,65511,65393,65753,65644,65469,65683,66229,66140,66228,66311,66190,66286,66066,65787,65658,65433,65398,65200,65098,64858,64660,63800,64112,63565,63621,63848,63862,63839,63622,64039,64168,64110,64475,64144,64381,63763,63453,63616,63165,63359,63334,63646,63511,63539,63746,63576,63657,63888,63938,64099,63904,64260,65633,65461,65695,65943,65481,65821,65846,65385,66226,66496,66740,67096,66841,66075,65938,66270,66220,66739,66782,66705,66934,66875,67177,66240,66239,65824)
ohlc <- data.frame(Open, High, Low, Close)

plot(Open, type = "line")